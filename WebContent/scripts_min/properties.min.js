var _dialogueListeners={};var _dialogueZindex=10012;var _dialogueRefeshProperties={};function addListener(c){var b="unknown";var a=c.closest("div.dialogue");if(a[0]&&!c.is("a.closeDialogue")){b=a.attr("id")}else{a=c.closest("div[data-dialogueid]");b=a.attr("data-dialogueid")}if(!_dialogueListeners[b]){_dialogueListeners[b]=[]}_dialogueListeners[b].push(c)}function removeListeners(c){if(c){for(var b in _dialogueListeners[c]){_dialogueListeners[c][b].unbind()}delete _dialogueListeners[c];if(c=="propertiesPanel"){c+="Div"}if(c=="actionsPanel"){c+="Div"}var d=$("#"+c).find("td[data-dialogueId]");if(d.length>0){d.each(function(){removeListeners($(this).attr("data-dialogueId"))})}}else{for(var b in _dialogueListeners){for(var a in _dialogueListeners[b]){_dialogueListeners[b][a].unbind()}delete _dialogueListeners[b]}}}function showProperties(e){removeListeners("propertiesPanel");var c=$(".propertiesPanelDiv");if(e){var l=_controlTypes[e.type];c.html("<h2>Properties<img id='helpProperties' class='headerHelp' src='images/help_16x16.png' /></h2>");
addHelp("helpProperties",true);c.append("<table class='propertiesPanelTable'><tbody></tbody></table>");var a=c.children().last().children().last();a.append("<tr><td colspan='2'><h3>"+l.name+"</h3></td></tr>");a.append("<tr><td colspan='2'></td></tr>");if(_version.showControlIds){a.append("<tr><td>ID</td><td class='canSelect'>"+e.id+"</td></tr>")}var h=l.properties;if(h){if($.isArray(h.property)){h=h.property}for(var f in h){a.append("<tr></tr>");var b=a.children().last();var k=h[f];if(k.visible===undefined||!k.visible===false){b.append("<td>"+k.name+"</td><td></td>");var j=b.children().last();if(k.changeValueJavaScript.trim().indexOf("function(")==0){try{var d=new Function(k.changeValueJavaScript);d.apply(this,[j,e,k])}catch(g){alert("Error - Couldn't apply changeValueJavaScript for "+e.name+"."+k.name+" "+g)}}else{if(window["Property_"+k.changeValueJavaScript]){window["Property_"+k.changeValueJavaScript](j,e,k)}else{alert("Error - There is no known Property_"+k.changeValueJavaScript+" function")
}}}}}}c.parent().css("height","auto")}function updateProperty(j,f,i,a,h){if(!_locked){var e=f[i.key];var d=$.isArray(e)||$.isPlainObject(e);if(e!=h||d){if(!d){addUndo()}f[i.key]=h;if(i.refreshHtml){rebuildHtml(f)}if(i.refreshProperties){if(j.closest("div.actionsPanelDiv")[0]){var b=j.closest("table[data-eventType]").attr("data-eventType");var g=j.closest("div.dialogue").attr("id");if(g){var c=_dialogueRefeshProperties[g];var j=c.cell;var f=c.propertyObject;var i=c.property;if(window["Property_"+i.changeValueJavaScript]){window["Property_"+i.changeValueJavaScript](j,f,i)}else{alert("Error - There is no known Property_"+i.changeValueJavaScript+" function")}}else{showActions(_selectedControl,b)}}else{showProperties(_selectedControl)}windowResize("updateProperty")}if(i.key=="name"){if($("#pageMap").is(":visible")){var k=_controlTypes[f.type];$("#pageMap").find("span[data-id="+f.id+"]").html(((k.image)?"<img src='"+k.image+"'/>":"")+f.type+(f.name?" - "+f.name:""))}}}}}function setPropertyVisibilty(b,g,e){var a=_controlTypes[b.type];
if(!a){a=_actionTypes[b.type]}if(b&&a&&a.properties){var d=a.properties;if($.isArray(d.property)){d=d.property}for(var c in d){var f=d[c];if(f.key==g){f.visible=e;break}}}}function getDialogue(i,c,h,a,b,g){var d=c.id+h.key;i.attr("data-dialogueId",d);var e=$("#propertiesDialogues").find("#"+d);var f=arguments.callee.caller.name;if(!e[0]){e=$("#propertiesDialogues").append("<div id='"+d+"' class='actionsPanelDiv dialogue' style='position:absolute;display:none;width:"+b+"px;z-index:10012;border:1px solid black;background-color:white;font-size:11px;padding:10px;'></div>").children().last();var j=e.append("<b style='float:left;margin-top:-5px;'>"+g+"</b><a href='#' class='closeDialogue' style='float:right;margin-top:-5px;'>close</a></div>").children().last();addListener(j.click({dialogueId:d},function(m){var k=$("#"+m.data.dialogueId);var l=k.find("td[data-dialogueId]");l.each(function(){var o=$(this).attr("data-dialogueId");var n=$("#"+o+":visible");if(n[0]){var p=n.find("a.closeDialogue");
p.click()}});k.remove();updateProperty(i,c,h,a,c[h.key])}));e.append("<br/><table style='width:100%' class='propertiesPanelTable dialogueTable'><tbody></tbody></table>")}addListener(i.click({dialogueId:d,propertyFunction:f},function(l){var k=$("#propertiesDialogues").find("#"+l.data.dialogueId);if(!k[0]){window[l.data.propertyFunction](i,c,h,a);k=$("#propertiesDialogues").find("#"+l.data.dialogueId)}k.css({left:i.offset().left+i.outerWidth()-k.outerWidth()+1,top:i.offset().top,"z-index":_dialogueZindex++});k.slideDown(500,function(){windowResize("PropertyDialogue show")})}));return e}function hideDialogues(){removeListeners();var a=$("#propertiesDialogues");a.children().remove()}function getDataItemDetails(a){if(a){var f=a.split(".");var e=f[0];var j=a;var b=getControlById(e);if(b){if(b._pageName){j=b._pageName+"."+b.name}else{j=b.name}if(f.length>1){var h=_controlTypes[b.type];var d=h.runtimeProperties;if(d){if($.isArray(d.runtimeProperty)){d=d.runtimeProperty}for(var c in d){var g=d[c];
if(f[1]==g.type){j+="."+g.name;break}}}}}return{id:e,name:j}}else{return{id:"",name:""}}}function Property_text(a,b,f,d){var e="";if(b[f.key]){e=b[f.key]}a.append("<input class='propertiesPanelTable' value='"+e+"' />");var c=a.children().last();addListener(c.keyup(function(g){updateProperty(a,b,f,d,g.target.value)}))}function Property_integer(a,b,f,d){var e="";if(b[f.key]||parseInt(b[f.key])==0){e=b[f.key]}a.append("<input class='propertiesPanelTable' value='"+e+"' />");var c=a.children().last();addListener(c.change(function(h){var g=$(h.target);var i=g.val();if(i.match(new RegExp("^\\d+$"))){updateProperty(a,b,f,d,h.target.value)}else{g.val(b[f.key])}}))}function Property_bigtext(a,c,f,d){var e="";if(c[f.key]){e=c[f.key]}a.text(e);var b=$("#propertiesDialogues").append("<textarea style='position:absolute;display:none;height:300px;width:600px;z-index:10012' wrap='off'></textarea>").children().last();b.text(e);addListener(a.click({textarea:b},function(g){b.css({left:a.offset().left+a.outerWidth()-605,top:a.offset().top,"z-index":_dialogueZindex++});
b.slideDown(500);b.focus()}));addListener(b.blur(function(g){a.text(b.val());b.hide();windowResize("Property_bigtext hide")}));addListener(b.keydown(textareaOverride));addListener(b.keyup(function(g){updateProperty(a,c,f,d,b.val())}))}function Property_select(n,e,l,a){var p="";var b=l.getValuesFunction;try{var g=new Function(b);var m=g.apply(e,[]);if($.isArray(m)){for(var d in m){if($.type(m[d])=="string"||$.type(m[d])=="number"||$.type(m[d])=="boolean"){if(e[l.key]==m[d]){p+="<option selected='selected'>"+m[d]+"</option>"}else{p+="<option>"+m[d]+"</option>"}}else{var k=m[d].value;if(!k){k=m[d][0]}var o=m[d].text;if(!o){o=m[d][1]}if(!o){o=k}if(e[l.key]==k){p+="<option value='"+k+"' selected='selected'>"+o+"</option>"}else{p+="<option value='"+k+"'>"+o+"</option>"}}}}else{p=m}}catch(h){alert("getValuesFunction failed for "+e.type+". "+h+"\r\r"+b)}n.append("<select class='propertiesPanelTable'>"+p+"</select>");var j=n.children().last();addListener(j.change({cell:n,propertyObject:e,property:l,details:a},function(f){updateProperty(f.data.cell,f.data.propertyObject,f.data.property,f.data.details,f.target.value)
}));var c=e[l.key];switch(c){case (true):c="true";break;case (false):c="false";break}j.val(c)}function Property_checkbox(a,b,f,d){var e="";if(b[f.key]&&b[f.key]!="false"){e="checked='checked'"}a.append("<input class='propertiesPanelTable' type='checkbox' "+e+" />");var c=a.children().last();addListener(c.change({cell:a,propertyObject:b,property:f,details:d},function(g){updateProperty(g.data.cell,g.data.propertyObject,g.data.property,g.data.details,g.target.checked)}))}function Property_inputAutoHeight(a,b,d,c){if(b.controlType=="L"){Property_checkbox(a,b,d)}else{a.closest("tr").remove()}}function Property_galleryImages(g,k,f,a){var d=getDialogue(g,k,f,a,200,"Images");var j=d.find("table").first();j.children().remove();if(!k.images){k.images=[]}var e=k.images;var h="";for(var c in e){h+=e[c].url;if(c<e.length-1){h+=","}}if(h){g.html(h)}else{g.html("Click to add...")}j.append("<tr><td  colspan='2' style='text-align:center;'>Url</td></tr>");for(var c in e){var b=e[c];j.append("<tr><td><input value='"+b.url+"' style='max-width:none;width:100%;' /></td><td style='width:32px'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>")
}addListener(j.find("input").keyup({cell:g,gallery:k,property:f,details:a,images:e},function(m){var i=$(m.target);var l=i.val();var n=m.data.images[i.closest("tr").index()-1];if(l!=n.url){addUndo();n.url=l}updateProperty(m.data.cell,m.data.gallery,m.data.property,m.data.details,m.data.images)}));addListener(j.find("img.delete").click(function(l){addUndo();var i=$(l.target);e.splice(i.index()-1);rebuildHtml(k);Property_galleryImages(g,k,f,a)}));addReorder(e,j.find("img.reorder"),function(){rebuildHtml(k);Property_galleryImages(g,k,f)});j.append("<tr><td colspan='3'><a href='#'>add...</a></td></tr>");addListener(j.find("a").click(function(i){e.push({url:""});Property_galleryImages(g,k,f,a)}))}function Property_imageFile(h,d,g,a){var e=getDialogue(h,d,g,a,200,"Image file");var j=e.find("table").first();j.children().remove();var f="";if(d[g.key]){f=d[g.key]}if(f){h.html(f)}else{h.html("Click to add...")}if(_version.images){j.append("<tr><td><select><option value=''>Please select...</option></select></td></tr>");
var k=j.find("select");for(var c in _version.images){var b="";if(_version.images[c]==d[g.key]){b=" selected='selected'"}k.append("<option"+b+">"+_version.images[c]+"</option>")}addListener(k.change(function(l){var i=$(this).val();updateProperty(h,d,g,a,i);window.setTimeout(function(){positionAndSizeBorder(_selectedControl);windowResize("Image file dropdown change")},200)}))}j.append("<tr><td><form id='form_"+d.id+"' method='post' enctype='multipart/form-data' target='uploadIFrame' action='designer?action=uploadImage&a="+_version.id+"&v="+_version.version+"&p="+_page.id+"&c="+d.id+"'><input id='file_"+d.id+"' name='file' type='file'></input></form></td></tr><tr><td><input type='submit' value='Upload' /></td></tr>");addListener(j.find("input[type=submit]").click({id:d.id},function(l){var i=$("#file_"+l.data.id).val();if(i){$("#form_"+l.data.id).submit()}}))}function Property_linkPage(a,b,d,c){if(b.linkType=="P"){Property_select(a,b,d,c)}else{a.parent().remove()}}function Property_linkURL(a,b,d,c){if(b.linkType=="U"){Property_bigtext(a,b,d,c)
}else{a.parent().remove()}}function Property_linkPopup(a,b,d,c){if(b.linkType=="U"){Property_checkbox(a,b,d,c)}else{a.parent().remove()}}function Property_pageName(a,f,e,c){var d=f.name;a.append("<input class='propertiesPanelTable' value='"+d+"' />");var b=a.children().last();addListener(b.keyup(function(k){var g=$(k.target);var l=g.val();var j="";var n=g.caret();for(var h=0;h<l.length;h++){var m=l.charCodeAt(h);if((m>=48&&m<=57)||(m>=65&&m<=90)||(m>=97&&m<=122)||m==45||m==95){j+=l.charAt(h)}else{n--}}if(l!=j){g.val(j);g.caret(n);l=j}updateProperty(a,f,e,c,l)}))}function Property_validationControls(j,e,g,a){var f=getDialogue(j,e,g,a,200,"Controls");var l=f.find("table").first();l.children().remove();var h=[];if(e[g.key]){h=e[g.key]}var k="";for(var d=0;d<h.length;d++){var c=getControlById(h[d]);if(c){k+=c.name}if(k&&d<h.length-1){k+=","}}if(!k){k="Click to add"}j.append(k);for(var d in h){var c=getControlById(h[d]);if(c){l.append("<tr><td>"+c.name+"</td><td style='width:32px'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>")
}else{h.splice(d,1)}}addListener(l.find("img.delete").click(function(i){var m=$(this).parent().parent();e.controls.splice(m.index(),1);m.remove()}));addReorder(h,l.find("img.reorder"),function(){Property_validationControls(j,e,g)});var b=l.append("<tr><td colspan='2'><select><option value=''>Add control...</option>"+getValidationControlOptions()+"</select></td></tr>").children().last().children().last().children().last();addListener(b.change({cell:j,propertyObject:e,property:g,details:a},function(i){var n=$(i.target);var m=n.val();if(m){if(!e.controls){e.controls=[]}e.controls.push(m);n.val("");Property_validationControls(i.data.cell,i.data.propertyObject,i.data.property,i.data.details)}}))}function Property_childActions(l,f,k,a){var h=getDialogue(l,f,k,a,200,k.name);var n=h.children().last().children().last();n.parent().removeClass("dialogueTable");n.children().remove();var d=[];if(f[k.key]){d=f[k.key]}var m="";for(var e=0;e<d.length;e++){m+=d[e].type;if(e<d.length-1){m+=","}}if(!m){m="Click to add..."
}l.text(m);if(d.length>0){n.append("<tr><td colspan='2'><img class='copyActions' src='images/copy_16x16.png' title='Copy all actions'/></td></tr>");addListener(n.find("img.copyActions").last().click({actionType:f.type,propertyName:k.name,actions:d,cell:l,propertyObject:f,property:k,details:a},function(i){_copyAction=i.data;Property_childActions(i.data.cell,i.data.propertyObject,i.data.property,i.data.details)}));n.append("<tr><td colspan='2'></td></tr>")}var c=_actionOptions;if(_copyAction){c="<optgroup label='New action'>"+_actionOptions+"</optgroup><optgroup label='Paste action'><option value='pasteActions'>"+getCopyActionName(f.id)+"</option></optgroup>"}var j=n.append("<tr><td colspan='2'><select><option value=''>Add action...</option>"+c+"</select></td></tr>").children().last().children().last().children().last();addListener(j.change({cell:l,propertyObject:f,property:k,details:a},function(q){var u=$(q.target);var p=u.val();if(p){var i=q.data.propertyObject;var s=q.data.property;if(!i[s.key]){i[s.key]=[]
}var t=i[s.key];if(p=="pasteActions"){if(_copyAction){_pasteMap={};if(_copyAction.actions){for(var o in _copyAction.actions){var r=_copyAction.actions[o];if(q.data.propertyObject.id!=r.id){t.push(new Action(r.type,r,true))}}}else{t.push(new Action(_copyAction.type,_copyAction,true))}}}else{t.push(new Action(p))}u.val("");Property_childActions(q.data.cell,q.data.propertyObject,q.data.property,q.data.details)}}));for(var e in d){var b=d[e];showAction(n,b,d,function(){Property_childActions(l,f,k)})}addReorder(d,n.find("img.reorder"),function(){Property_childActions(l,f,k)});var g=h.attr("id");_dialogueRefeshProperties[g]={cell:l,propertyObject:f,property:k}}function Property_childActionsForType(m,e,l,a){if(a&&a.type){var g=_actionTypes[a.type];if(g){var h=getDialogue(m,e,l,a,200,"Child "+g.name+" actions");var o=h.children().last().children().last();o.parent().removeClass("dialogueTable");o.children().remove();var c=[];if(e[l.key]){c=e[l.key]}var n="";for(var d=0;d<c.length;d++){n+=c[d].type;
if(d<c.length-1){n+=","}}if(!n){n="Click to add..."}m.text(n);if(c.length>0){o.append("<tr><td colspan='2'></td></tr>")}var j=o.append("<tr><td colspan='2'><a href='#' style='float:left;'>add...</a></td></tr>").children().last().children().last().children().last();addListener(j.click({cell:m,propertyObject:e,property:l,details:a},function(p){var r=new Action(p.data.details.type);if(r){var i=p.data.propertyObject;var q=p.data.property;if(!i[q.key]){i[q.key]=[]}i[q.key].push(r);Property_childActionsForType(p.data.cell,i,q,p.data.details)}}));if(_copyAction&&_copyAction.type==a.type){var k=j.after("<a href='#' style='float:right;margin-right:5px;'>paste...</a>").next();addListener(k.click({cell:m,propertyObject:e,property:l,details:a},function(p){var i=p.data.propertyObject;if(_copyAction&&_copyAction.type==i.type){var q=p.data.property;if(!i[q.key]){i[q.key]=[]}var r=i[q.key];r.push(new Action(_copyAction.type,_copyAction,true));Property_childActionsForType(p.data.cell,i,q,p.data.details)
}}))}for(var d in c){var b=c[d];showAction(o,b,c,function(){Property_childActionsForType(m,e,l,a)})}addReorder(c,o.find("img.reorder"),function(){Property_childActionsForType(m,e,l,a)});var f=h.attr("id");_dialogueRefeshProperties[f]={cell:m,propertyObject:e,property:l}}else{m.text("Action "+a.type+" not found")}}else{m.text("Action type not provided")}}function Property_databaseQuery(a,l,e,q){var s=getDialogue(a,l,e,q,1000,"Query");var r=s.children().last().children().last();r.children().remove();if(!l.query){l.query={inputs:[],sql:"select field1, field2\nfrom table\nwhere field3 = ?",databaseConnectionIndex:0,outputs:[]}}var d=l.query;var k=d.SQL;if(!k){k="Click to define..."}a.text(k);r.append("<tr><td colspan='2' rowspan='3' style='padding:0px;vertical-align: top;'><table style='width:100%' class='propertiesPanelTable'><tr><td><b>Input</b></td><td colspan='2'><b>Field</b></td></tr></table></td><td colspan='3' style='width:500px;padding:0px 6px 0px 0px;'><b>SQL</b><br/><textarea style='width:100%;min-height:300px;'></textarea></td><td colspan='2' rowspan='3' style='padding:0px;vertical-align: top;'><table style='width:100%' class='propertiesPanelTable'><tr><td><b>Field</b></td><td colspan='2'><b>Output</b></td></tr></table></td></tr>");
var m=r.children().last().children().first().children("table");for(var n in d.inputs){var o=d.inputs[n].itemId;var h=getDataItemDetails(o);if(h&&h.name){o=h.name}var b=d.inputs[n].field;if(!b){b=""}m.append("<tr><td style='min-width:100px;'>"+(d.multiRow&&n>0?"&nbsp;":o)+"</td><td><input value='"+b+"' /></td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var c=m.find("tr").last().children(":nth(1)").last().children().last();addListener(c.keyup({parameters:d.inputs},function(y){var i=$(y.target);y.data.parameters[i.parent().parent().index()-1].field=i.val()}));var w=m.find("tr").last().children().last().children("img.delete");addListener(w.click({parameters:d.inputs},function(y){var i=$(y.target);y.data.parameters.splice(i.parent().parent().index()-1,1);i.parent().parent().remove()}))}addReorder(d.inputs,m.find("img.reorder"),function(){Property_databaseQuery(a,l,e)
});if(d.multiRow&&d.inputs.length>0){m.append("<tr><td style='padding:0px;' colspan='2'><a href='#' style='padding-left:5px;'>add input</a></td><td>&nbsp;</td></tr>");var g=m.find("tr").last().children().first().children("a");addListener(g.click({cell:a,propertyObject:l,property:e,details:q},function(y){var i=y.data.propertyObject.query.inputs;i.push({itemId:i[0].itemId,field:""});Property_databaseQuery(y.data.cell,y.data.propertyObject,y.data.property,y.data.details)}))}else{m.append("<tr><td style='padding:0px;' colspan='2'><select style='margin:0px'><option value=''>add input...</option>"+getInputOptions()+"</select></td><td>&nbsp;</td></tr>");var g=m.find("tr").last().children().first().children("select");addListener(g.change({cell:a,propertyObject:l,property:e,details:q},function(y){if(!y.data.propertyObject.query.inputs){y.data.propertyObject.query.inputs=[]}var i=y.data.propertyObject.query.inputs;i.push({itemId:$(y.target).val(),field:""});Property_databaseQuery(y.data.cell,y.data.propertyObject,y.data.property,y.data.details)
}))}var p=r.find("textarea").first();p.text(d.SQL);addListener(p.keyup({query:d},function(i){d.SQL=$(i.target).val()}));var t=r.children().last().children().last().children().last();for(var n in d.outputs){var o=d.outputs[n].itemId;var h=getDataItemDetails(o);if(h&&h.name){o=h.name}var b=d.outputs[n].field;if(!b){b=""}t.append("<tr><td><input value='"+b+"' /></td><td>"+o+"</td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var x=t.find("tr").last().children().first().children().last();addListener(x.keyup({parameters:d.outputs},function(y){var i=$(y.target);y.data.parameters[i.parent().parent().index()-1].field=i.val()}));var w=t.find("tr").last().children().last().children("img.delete");addListener(w.click({parameters:d.outputs},function(y){var i=$(y.target);y.data.parameters.splice(i.parent().parent().index()-1,1);i.parent().parent().remove()}))}addReorder(d.outputs,t.find("img.reorder"),function(){Property_databaseQuery(a,l,e)
});t.append("<tr><td>&nbsp;</td><td style='padding:0px;'><select style='margin:0px'><option value=''>add output...</option>"+getOutputOptions()+"</select></td><td>&nbsp;</td></tr>");var f=t.find("tr").last().children(":nth(1)").last().children().last();addListener(f.change({cell:a,propertyObject:l,property:e,details:q},function(y){if(!y.data.propertyObject.query.outputs){y.data.propertyObject.query.outputs=[]}var i=y.data.propertyObject.query.outputs;i.push({itemId:$(y.target).val(),field:""});Property_databaseQuery(y.data.cell,y.data.propertyObject,y.data.property,y.data.details)}));r.append("<tr><td>Multi-row data? <input type='checkbox'"+(d.multiRow?"checked='checked'":"")+" style='vertical-align: middle;margin-top: -3px;'/></td><td style='text-align: center;'>Database connection <select style='width:auto;'>"+getDatabaseConnectionOptions(d.databaseConnectionIndex)+"</select></td><td style='text-align:right;'><button>Test SQL</button></td></tr>");var u=r.find("tr").last().find("input");
addListener(u.change({cell:a,propertyObject:l,property:e,details:q,query:d},function(i){i.data.query.multiRow=$(i.target).is(":checked");Property_databaseQuery(i.data.cell,i.data.propertyObject,i.data.property,i.data.details)}));var j=r.find("tr").last().find("select");addListener(j.change({query:d},function(i){i.data.query.databaseConnectionIndex=i.target.selectedIndex}));var v=r.find("tr").last().find("button");addListener(v.click({query:d},function(i){var y=JSON.stringify(i.data.query);$.ajax({url:"designer?a="+_version.id+"&v="+_version.version+"&action=testSQL",type:"POST",contentType:"application/json",dataType:"json",data:y,error:function(B,z,A){alert(A+" : "+B.responseText)},success:function(z){alert(z.message)}})}))}function Property_databaseChildActions(a,b,d,c){Property_childActionsForType(a,b,d,{type:"database"})}function Property_webserviceRequest(a,m,f,r){var t=getDialogue(a,m,f,r,1000,"Webservice request");var s=t.children().last().children().last();s.children().remove();
if(!m.request){m.request={inputs:[],type:"SOAP",url:"soa",action:"demo.Samplewebservice",body:'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soa="http://soa.rapid-is.co.uk">\n  <soapenv:Body>\n    <soa:personSearchRequest>\n      <soa:surname>A</soa:surname>\n    </soa:personSearchRequest>\n  </soapenv:Body>\n</soapenv:Envelope>',outputs:[]}}var d=m.request;var k=d.type;if(!k){k="Click to define..."}a.text(k);s.append("<tr><td colspan='2' rowspan='3' style='padding:0px;vertical-align: top;'><table style='width:100%' class='propertiesPanelTable'><tr><td><b>Input</b></td><td colspan='2'><b>Field</b></td></tr></table></td><td colspan='2' style='width:500px;padding:0px 6px 0px 0px;'><b style='display:block;margin-bottom:-5px;'>Request type</b><br/><input type='radio' name='WSType' value='SOAP'/>SOAP<input type='radio' name='WSType' value='JSON'/>JSON<input type='radio' name='WSType' value='XML'/>XML/Restfull</br><b style='display:block;margin-top:5px;margin-bottom:-5px;'>URL</b><br/><input class='WSUrl' style='max-width:inherit;width:100%' /></br><b style='display:block;margin-top:5px;margin-bottom:-5px;'>Action</b><br/><input class='WSAction' style='max-width:inherit;width:100%' /></br><b style='display:block;margin-top:5px;margin-bottom:-5px;'>Body</b><br/><textarea style='width:100%;min-height:300px;' class='WSBody'></textarea></br><b style='display:block;margin-top:5px;margin-bottom:-5px;'>Response root element</b><br/><input class='WSRoot' style='max-width:inherit;width:100%;margin-bottom:5px;' /></td><td colspan='2' rowspan='3' style='padding:0px;vertical-align: top;'><table style='width:100%' class='propertiesPanelTable'><tr><td><b>Field</b></td><td colspan='2'><b>Output</b></td></tr></table></td></tr>");
var o=s.children().last().children().first().children().last();for(var p in d.inputs){var q=d.inputs[p].itemId;var j=getDataItemDetails(q);if(j&&j.name){q=j.name}var b=d.inputs[p].field;if(!b){b=""}o.append("<tr><td>"+q+"</td><td><input value='"+b+"' /></td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var c=o.find("tr").last().children(":nth(1)").last().children().last();addListener(c.keyup({parameters:d.inputs},function(y){var i=$(y.target);y.data.parameters[i.parent().parent().index()-1].field=i.val()}));var w=o.find("tr").last().children().last().children("img.delete");addListener(w.click({parameters:d.inputs},function(y){var i=$(y.target);y.data.parameters.splice(i.parent().parent().index()-1,1);i.parent().parent().remove()}))}addReorder(d.inputs,o.find("img.reorder"),function(){Property_webserviceRequest(a,m,f)});o.append("<tr><td style='padding:0px;'><select style='margin:0px'><option value=''>Add input...</option>"+getInputOptions()+"</select></td><td>&nbsp;</td><td>&nbsp;</td></tr>");
var h=o.find("tr").last().children().first().children().first();addListener(h.change({cell:a,propertyObject:m,property:f,details:r},function(y){if(!y.data.propertyObject.request.inputs){y.data.propertyObject.request.inputs=[]}var i=y.data.propertyObject.request.inputs;i.push({itemId:$(y.target).val(),field:""});Property_webserviceRequest(y.data.cell,y.data.propertyObject,y.data.property,y.data.details)}));var v=s.find("input[type=radio]");v.filter("[value="+d.type+"]").prop("checked","true");addListener(v.click({request:d},function(i){i.data.request.type=$(i.target).val()}));var n=s.find("input.WSUrl");n.val(d.url);addListener(n.keyup({request:d},function(i){i.data.request.url=$(i.target).val()}));var n=s.find("input.WSAction");n.val(d.action);addListener(n.keyup({request:d},function(i){i.data.request.action=$(i.target).val()}));var e=s.find("textarea");e.text(d.body);addListener(e.keyup({request:d},function(i){i.data.request.body=$(i.target).val()}));var l=s.find("input.WSRoot");l.val(m.root);
addListener(l.keyup({propertyObject:m},function(i){i.data.propertyObject.root=$(i.target).val()}));var u=s.children().last().children().last().children().last();for(var p in d.outputs){var q=d.outputs[p].itemId;var j=getDataItemDetails(q);if(j&&j.name){q=j.name}var b=d.outputs[p].field;if(!b){b=""}u.append("<tr><td><input value='"+b+"' /></td><td>"+q+"</td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var x=u.find("tr").last().children().first().children().last();addListener(x.keyup({parameters:d.outputs},function(y){var i=$(y.target);y.data.parameters[i.parent().parent().index()-1].field=i.val()}));var w=u.find("tr").last().children().last().children("img.delete");addListener(w.click({parameters:d.outputs},function(y){var i=$(y.target);y.data.parameters.splice(i.parent().parent().index()-1,1);i.parent().parent().remove()}))}addReorder(d.outputs,u.find("img.reorder"),function(){Property_webserviceRequest(a,m,f,r)
});u.append("<tr><td>&nbsp;</td><td style='padding:0px;'><select style='margin:0px'><option value=''>Add output...</option>"+getOutputOptions()+"</select></td><td>&nbsp;</td></tr>");var g=u.find("tr").last().children(":nth(1)").last().children().last();addListener(g.change({cell:a,propertyObject:m,property:f,details:r},function(y){if(!y.data.propertyObject.request.outputs){y.data.propertyObject.request.outputs=[]}var i=y.data.propertyObject.request.outputs;i.push({itemId:$(y.target).val(),field:""});Property_webserviceRequest(y.data.cell,y.data.propertyObject,y.data.property,y.data.details)}))}function Property_navigationPage(a,e,d,c){a.append("<select><option value=''>Please select...</option>"+getPageOptions(e.page)+"</select>");var b=a.find("select").last();addListener(b.change({cell:a,navigationAction:e,property:d,details:c},function(f){value=$(f.target).val();updateProperty(f.data.cell,f.data.navigationAction,f.data.property,f.data.details,value)}))}function Property_pageSessionVariables(j,f,h,a,b){var k=[];
if(f.sessionVariables){k=f.sessionVariables}var l="";for(var c=0;c<k.length;c++){l+=k[c];if(c<k.length-1){l+=","}}if(!l){l="Click to add..."}j.text(l);if(!b){var e=getDialogue(j,f,h,a,200,"Page variables");var n=e.find("table").first();n.children().remove();for(var c in k){n.append("<tr><td style='padding-left:0px'><input class='variable' value='"+k[c]+"' /></td><td><img src='images/bin_16x16.png' style='float:right;' /></td></tr>");var d=n.find("input.variable").last();addListener(d.keyup({cell:j,page:f,property:h,details:a},function(p){var i=$(p.target);var q=i.val();var o=i.closest("tr").index();p.data.page.sessionVariables[o]=q;Property_pageSessionVariables(p.data.cell,p.data.page,p.data.property,p.data.details,true)}));var g=n.find("tr").last().children().last().children().last();addListener(g.click({variables:k},function(o){addUndo();var i=$(o.target);o.data.variables.splice(i.parent().parent().index(),1);i.parent().parent().remove()}))}n.append("<tr><td colspan='2'><a href='#'>add...</a></td></tr>");
var m=n.find("tr").last().children().last().children().last();addListener(m.click({cell:j,page:f,property:h,details:a},function(i){addUndo();if(!i.data.page.sessionVariables){i.data.page.sessionVariables=[]}i.data.page.sessionVariables.push("");Property_pageSessionVariables(i.data.cell,i.data.page,i.data.property,i.data.details)}))}}function Property_roles(h,c,g,a){var e=getDialogue(h,c,g,a,200,"User roles");var l=e.find("table").first();l.children().remove();var d=[];if(c.roles){d=c.roles}var j="";for(var b=0;b<d.length;b++){j+=d[b];if(b<d.length-1){j+=","}}if(!j){j="Click to add..."}h.text(j);for(var b in d){l.append("<tr><td style='padding-left:0px'>"+d[b]+"</td><td><img src='images/bin_16x16.png' style='float:right;' /></td></tr>");var f=l.find("tr").last().children().last().children().last();addListener(f.click({roles:d,cell:h,control:c,property:g,details:a},function(m){var i=$(m.target);m.data.roles.splice(i.parent().parent().index(),1);i.parent().parent().remove();Property_roles(m.data.cell,m.data.control,m.data.property,m.data.details)
}))}l.append("<tr><td colspan='2'><select><option value=''>add...</option>"+getRolesOptions(null,d)+"</td></tr>");var k=l.find("tr").last().children().last().children().last();addListener(k.change({cell:h,control:c,property:g,details:a},function(i){if(!i.data.control.roles){i.data.control.roles=[]}var m=i.target.value;if(m){i.data.control.roles.push(m)}Property_roles(i.data.cell,i.data.control,i.data.property,i.data.details)}))}function Property_navigationSessionVariables(n,d,m,a){if(d.linkType&&d.linkType!="P"){n.parent().remove();return false}var h=getDialogue(n,d,m,a,300,"Set page variables");var p=h.find("table").first();p.children().remove();var k=null;for(var f in _pages){if(_pages[f].id==d.page){k=_pages[f]}}if(k){if(!d.sessionVariables||d.sessionVariables=="[]"){d.sessionVariables=[]}if(k.sessionVariables.length==0){d.sessionVariables=[]}var c=d.sessionVariables;var o="";for(var f=0;f<c.length;f++){o+=c[f].name;if(f<c.length-1){o+=","}}if(!o){o="Click to add..."}n.text(o);p.append("<tr><td><b>Variable</b></td><td><b>Input</b></td><td><b>Field</b></td></tr>");
for(var f in k.sessionVariables){var g=c[f];if(!g||g.name!=k.sessionVariables[f]){g={name:k.sessionVariables[f],itemId:"",field:""};c.splice(f,0,g)}var b=g.name;var e=getControlById(b);if(e){b=e.name}p.append("<tr><td>"+b+"</td><td><select><option value=''>Please select...</option>"+getInputOptions(g.itemId)+"</select></td><td style='padding-left:0px'><input value='"+g.field+"' /></td></tr>");var l=p.find("select").last();addListener(l.change({sessionVariables:c},function(q){var i=$(q.target);q.data.sessionVariables[i.parent().parent().index()-1].itemId=i.val()}));var j=p.find("input").last();addListener(j.keyup({sessionVariables:c},function(q){var i=$(q.target);q.data.sessionVariables[i.parent().parent().index()-1].field=i.val()}))}if(c.length>f){c.splice(f*1+1,c.length)}}else{n.parent().hide()}}function Property_navigationStopActions(b,a,d,c){if(a.dialogue){Property_checkbox(b,a,d,c)}else{b.parent().hide()}}function Property_radiobuttons(k,f,j,a){var d=getDialogue(k,f,j,a,200,"Radio buttons");
var n=d.find("table").first();n.children().remove();var e=[];if(f.buttons){e=f.buttons}var l="";for(var b=0;b<e.length;b++){l+=e[b].label;if(f.codes){l+=" ("+e[b].value+")"}if(b<e.length-1){l+=","}}if(!l){l="Click to add..."}k.text(l);n.append("<tr>"+(f.codes?"<td><b>Code</b></td>":"")+"<td colspan='2'><b>Text</b></td></tr>");for(var b in e){n.append("<tr>"+(f.codes?"<td style='padding-left:0px'><input class='value' value='"+e[b].value+"' /></td>":"")+"<td style='padding-left:0px'><input class='label' value='"+e[b].label+"' /></td><td><img src='images/bin_16x16.png' style='float:right;' /></td></tr>");var c=n.find("input.value").last();addListener(c.keyup({radiobuttons:f,buttons:e},function(p){var i=$(p.target);p.data.buttons[i.parent().parent().index()-1].value=i.val();rebuildHtml(p.data.radiobuttons)}));var h=n.find("input.label").last();addListener(h.keyup({radiobuttons:f,buttons:e},function(p){var i=$(p.target);p.data.buttons[i.parent().parent().index()-1].label=i.val();rebuildHtml(p.data.radiobuttons)
}));var g=n.find("tr").last().children().last().children().last();addListener(g.click({cell:k,radiobuttons:f,property:j,details:a},function(p){var i=$(p.target);p.data.radiobuttons.buttons.splice(i.parent().parent().index()-1,1);i.parent().parent().remove();if(i.parent().index()==1){rebuildHtml(p.data.radiobuttons)}Property_radiobuttons(p.data.cell,p.data.radiobuttons,p.data.property,p.data.details)}))}n.append("<tr><td colspan='"+(f.codes?"3":"2")+"'><a href='#'>add...</a></td></tr>");var m=n.find("tr").last().children().last().children().last();addListener(m.click({cell:k,radiobuttons:f,property:j,details:a},function(i){i.data.radiobuttons.buttons.push({value:"",label:""});Property_radiobuttons(i.data.cell,i.data.radiobuttons,i.data.property,i.data.details)}));if(!d.find("input[type=checkbox]")[0]){d.append("Use codes <input type='checkbox' "+(f.codes?"checked='checked'":"")+" />");var o=d.children().last();addListener(o.change({cell:k,radiobuttons:f,buttons:e,property:j,details:a},function(i){i.data.radiobuttons.codes=i.target.checked;
Property_radiobuttons(i.data.cell,i.data.radiobuttons,i.data.property,i.data.details)}))}}var _logicOperations=[["==","= equals"],["!=","!= doesn't equal"],[">","> greater than"],[">=",">= greater than or equal to"],["<","< less than"],["<=","<= less than or equal to"]];function logicConditionText(e){var d="Not set";switch(e.type){case"CTL":var c=null;var a=e.id.split(".");var b=a;if(a.length>1){b=a[0]}if(b){c=getControlById(b)}d=(c?c.name:e.id);if(a.length>1){d+="."+a[1]}if(e.field){d+="."+e.field}break;case"SYS":d=e.id.split(".")[1];break}return d}function logicConditionValue(h,c,d,a){var b=c.conditions[d];if(!b[a]){b[a]={type:"CTL"}}var g=b[a];h.html("<table class='propertiesPanelTable'></table>");var i=h.find("table").last();i.append("<tr><td>"+(a=="value1"?"Item 1":"Item 2")+"</td><td><select>"+getInputOptions(g.id)+"</select></td></tr>");var f=i.find("select");if(!g.id){g.id=f.val()}addListener(i.find("select").change(function(k){var l=$(k.target).val();var j="CTL";if(l.substr(0,7)=="System."){j="SYS"
}g.type=j;g.id=l;logicConditionValue(h,c,d,a)}));switch(g.type){case"CTL":i.append("<tr><td>Field</td><td><input /></td></tr>");var e=i.find("input").last();if(g.field){e.val(g.field)}addListener(e.keyup(function(j){g.field=$(j.target).val()}));break;case"SYS":if(g.id=="System.field"){i.append("<tr><td>Value</td><td><input /></td></tr>");var e=i.find("input").last();if(g.field){e.val(g.field)}addListener(e.keyup(function(j){g.field=$(j.target).val()}))}break}}function Property_logicConditions(o,f,n,a){var l=getDialogue(o,f,n,a,500,"Conditions");var s=l.find("table").first();s.addClass("dialogueTable");s.children().remove();var m=f[n.key];if(!m){m=[]}var p="";for(var h in m){var d=m[h];s.append("<tr><td style='vertical-align:top;'></td><td style='vertical-align:top;'></td><td style='vertical-align:top;'></td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");
var r=s.find("tr").last();var e=r.children("td:nth(0)");var c=r.children("td:nth(2)");var k=r.children("td:nth(1)");logicConditionValue(e,f,h,"value1");logicConditionValue(c,f,h,"value2");var b="<select style='margin-top:1px;'>";for(var g in _logicOperations){b+="<option value='"+_logicOperations[g][0]+"'"+(d.operation==_logicOperations[g][0]?" selected='selected'":"")+">"+_logicOperations[g][1]+"</option>"}b+="</select>";k.append(b);k.find("select").last().change({condition:d},function(i){i.data.condition.operation=$(i.target).val()});p+=logicConditionText(d.value1)+" "+(d.operation=="=="?"=":d.operation)+" "+logicConditionText(d.value2);if(h<m.length-1){p+=" "+f.conditionsType+" "}}if(!p){p="Click to add..."}o.text(p);var q=s.find("img.delete");addListener(q.click({conditions:m},function(j){var i=$(j.target);j.data.conditions.splice(i.parent().parent().index(),1);if(j.data.conditions.length<2){$(j.target).closest("table").find("tr:last").prev().remove()}i.parent().parent().remove()}));
addReorder(m,s.find("img.reorder"),function(){Property_logicConditions(o,f,n,a)});if(m.length>1){s.append("<tr><td colspan='4' style='padding-left:12px;'><input type='radio' name='"+f.id+"type' value='and'"+(f.conditionsType=="and"?" checked='checked'":"")+"/>all conditions must be true (And) <input type='radio' name='"+f.id+"type' value='or'"+(f.conditionsType=="or"?" checked='checked'":"")+"/>any condition can be true (Or) </td></tr>");s.find("input[name="+f.id+"type]").change(function(i){f.conditionsType=$(i.target).val()})}s.append("<tr><td colspan='4'><a href='#'>add...</a></td></tr>");s.find("a").last().click(function(i){if(!f.conditions){f.conditions=[]}f.conditions.push({value1:{type:"CTL"},operation:"==",value2:{type:"CTL"}});Property_logicConditions(o,f,n,a)})}function Property_options(h,c,g,a){var e=getDialogue(h,c,g,a,200,"Options");var m=e.find("table").first();m.children().remove();var o=[];if(c.options){o=c.options}var j="";for(var b=0;b<o.length;b++){j+=o[b].text;if(c.codes){j+=" ("+o[b].value+")"
}if(b<o.length-1){j+=","}}if(!j){j="Click to add..."}h.text(j);m.append("<tr><td><b>Text</b></td>"+(c.codes?"<td colspan='2'><b>Code</b></td>":"")+"</tr>");for(var b in o){m.append("<tr><td style='padding-left:0px'><input class='text' value='"+o[b].text+"' /></td>"+(c.codes?"<td style='padding-left:0px'><input class='value' value='"+o[b].value+"' /></td>":"")+"<td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var f=m.find("input.text").last();addListener(f.keyup({control:c,options:o},function(p){var i=$(p.target);p.data.options[i.parent().parent().index()-1].text=i.val();if(i.parent().parent().index()==1||c.type!="dropdown"){rebuildHtml(c)}}));var d=m.find("input.value").last();addListener(d.keyup({options:o},function(p){var i=$(p.target);p.data.options[i.parent().parent().index()-1].value=i.val()}))}var l=m.find("img.delete");addListener(l.click({options:o},function(p){var i=$(p.target);
p.data.options.splice(i.parent().parent().index()-1,1);i.parent().parent().remove();if(i.parent().index()==1){rebuildHtml(c)}}));addReorder(o,m.find("img.reorder"),function(){rebuildHtml(c);Property_options(h,c,g,a)});m.append("<tr><td colspan='"+(c.codes?"3":"2")+"'><a href='#'>add...</a></td></tr>");var k=m.find("tr").last().children().last().children().last();addListener(k.click({cell:h,control:c,property:g,details:a},function(i){i.data.control.options.push({value:"",text:""});Property_options(i.data.cell,i.data.control,i.data.property,i.data.details)}));if(!e.find("input[type=checkbox]")[0]){e.append("Use codes <input type='checkbox' "+(c.codes?"checked='checked'":"")+" />");var n=e.children().last();addListener(n.change({cell:h,control:c,options:o,property:g,details:a},function(i){c.codes=i.target.checked;Property_options(i.data.cell,i.data.control,i.data.property,i.data.details)}))}}function Property_gridColumns(b,a,e,o){var r=getDialogue(b,a,e,o,650,"Columns");var p=r.find("table").first();
p.children().remove();var c=a.columns;if(!c||c=="[]"){c=[]}var g="";for(var m=0;m<c.length;m++){g+=c[m].title;if(m<c.length-1){g+=","}}if(!g){g="Click to add..."}b.text(g);p.append("<tr><td style='width:20px;'><b>Visible</b></td><td><b>Title</b></td><td><b>Title style</b></td><td><b>Field</b></td><td><b>Field style</b></td><td colspan='2'><b>Cell function</b></td></tr>");for(var m in c){var j="...";if(c[m].cellFunction){j=c[m].cellFunction}p.append("<tr><td style='text-align:center;'><input type='checkbox' "+(c[m].visible?"checked='checked'":"")+" /></td><td style='padding-left:0px'><input style='max-width:none;' value='"+c[m].title+"' /></td><td style='padding-left:0px'><input style='max-width:none;' value='"+c[m].titleStyle+"' /></td><td style='padding-left:0px'><input style='max-width:none;' value='"+c[m].field+"' /></td><td style='padding-left:0px'><input style='max-width:none;' value='"+c[m].fieldStyle+"' /></td><td style='width:20px;max-width:100px;padding-left:5px'>"+j.replaceAll("<","&lt;")+"</td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");
var q=p.find("tr").last().children(":nth(0)").first().children().first();addListener(q.change({grid:a},function(t){var i=$(t.target);t.data.grid.columns[i.parent().parent().index()-1].visible=t.target.checked;rebuildHtml(a)}));var k=p.find("tr").last().children(":nth(1)").first().children().first();addListener(k.keyup({grid:a},function(t){var i=$(t.target);t.data.grid.columns[i.parent().parent().index()-1].title=i.val();rebuildHtml(a)}));var d=p.find("tr").last().children(":nth(2)").first().children().first();addListener(d.keyup({grid:a},function(t){var i=$(t.target);t.data.grid.columns[i.parent().parent().index()-1].titleStyle=i.val();rebuildHtml(a)}));var n=p.find("tr").last().children(":nth(3)").first().children().first();addListener(n.keyup({grid:a},function(t){var i=$(t.target);t.data.grid.columns[i.parent().parent().index()-1].field=i.val();rebuildHtml(a)}));var f=p.find("tr").last().children(":nth(4)").first().children().first();addListener(f.keyup({grid:a},function(t){var i=$(t.target);
t.data.grid.columns[i.parent().parent().index()-1].fieldStyle=i.val();rebuildHtml(a)}));var f=p.find("tr").last().children(":nth(5)").first();addListener(f.click({grid:a},function(u){var v=$(u.target);var i=v.parent().index()-1;s.attr("data-index",i);var t=u.data.grid.columns[i].cellFunction;if(t){s.val(t)}s.show().focus()}))}var s=r.append("<textarea data-index='-1' style='position:absolute;display:none;width:500px;height:300px;top:26px;right:10px;'  wrap='off'></textarea>").find("textarea:first");addListener(s.blur(function(t){var u=s.val();if(!u){u="..."}var i=s.attr("data-index")*1;if(i>=0){p.find("tr:nth("+(i+1)+")").last().children("td:nth(5)").html(u)}s.val("");s.hide()}));addListener(s.keyup({grid:a},function(t){var i=s.attr("data-index")*1;if(i>=0){t.data.grid.columns[i].cellFunction=s.val()}}));var l=p.find("img.delete");addListener(l.click({columns:c},function(t){var i=$(t.target);t.data.columns.splice(i.parent().parent().index()-1,1);i.parent().parent().remove();rebuildHtml(a)
}));addReorder(c,p.find("img.reorder"),function(){rebuildHtml(a);Property_gridColumns(b,a,e,o)});p.append("<tr><td colspan='5'><a href='#'>add...</a></td></tr>");var h=p.find("tr").last().children().last().children().last();addListener(h.click({cell:b,grid:a,property:e,details:o},function(i){i.data.grid.columns.push({visible:true,title:"",titleStyle:"",field:"",fieldStyle:"",cellFunction:""});Property_gridColumns(i.data.cell,i.data.grid,i.data.property,i.data.details)}))}function Property_controlHints(c,l,d,p){var r=getDialogue(c,l,d,p,500,"Control hints");var q=r.find("table").first();q.children().remove();var j="";var b=l.controlHints;if(!b||b=="[]"){b=[]}q.append("<tr><td><b>Control</b></td><td><b>Action</b></td><td style='min-width:150px;max-width:150px;'><b>Hint text</b></td><td colspan='2'><b>Style</b></td></td></tr>");for(var n in b){var h=b[n];var g=getControlById(h.controlId);if(g){j+=g.name}var o="<option value='hover'"+((h.type=="hover")?" selected":"")+">hover</option><option value='click'"+((h.type=="click")?" selected":"")+">click</option>";
q.append("<tr class='nopadding'><td><select class='control'><option value=''>Please select...</option>"+getControlOptions(h.controlId)+"</select></td><td><select class='type'>"+o+"</select></td><td style='max-width:150px;'><span>"+h.text+"</span></td><td><input value='"+h.style+"'/></td><td style='width:32px;'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");if(n<b.length-1){j+=","}}if(!j){j="Click to add..."}c.text(j);var f=q.find("select.control");addListener(f.change({controlHints:b},function(t){var i=$(t.target);t.data.controlHints[i.parent().parent().index()-1].controlId=i.val()}));var s=q.find("select.type");addListener(s.change({controlHints:b},function(t){var i=$(t.target);t.data.controlHints[i.parent().parent().index()-1].type=i.val()}));var a=q.find("span");a.each(function(){var i=$(this);Property_bigtext(i.parent(),b[i.parent().parent().index()-1],{key:"text"})});var e=q.find("input");
addListener(e.change({controlHints:b},function(t){var i=$(t.target);t.data.controlHints[i.parent().parent().index()-1].style=i.val()}));var m=q.find("img.delete");addListener(m.click({controlHints:b},function(t){var i=$(t.target);t.data.controlHints.splice(i.parent().parent().index()-1,1);i.parent().parent().remove();rebuildHtml(b)}));addReorder(b,q.find("img.reorder"),function(){rebuildHtml(l);Property_controlHints(c,l,d,p)});q.append("<tr><td colspan='4'><a href='#'>add...</a></td></tr>");var k=q.find("tr").last().children().last().children().last();addListener(k.click({cell:c,hints:l,property:d,details:p},function(i){if(!i.data.hints.controlHints){i.data.hints.controlHints=[]}i.data.hints.controlHints.push({controlId:"",type:"hover",text:"",style:""});Property_controlHints(i.data.cell,i.data.hints,i.data.property,i.data.details)}))}function Property_slidePanelVisibility(a,b,d,c){a.text(b.visible);addListener(a.click(function(f){addUndo();var e=b;e.visible=!e.visible;if(e.visible){e.object.addClass("slidePanelOpen");
e.object.removeClass("slidePanelClosed")}else{e.object.addClass("slidePanelClosed");e.object.removeClass("slidePanelOpen")}rebuildHtml(b);$(f.target).text(e.visible)}))}function Property_flowLayoutCellWidth(a,b,f,d){var e="";if(b[f.key]){e=b[f.key]}a.append("<input class='propertiesPanelTable' value='"+e+"' />");var c=a.children().last();addListener(c.keyup(function(h){updateProperty(a,b,f,d,h.target.value);var g=_pageIframe[0].contentWindow||_pageIframe[0];g[b.id+"details"]={};g[b.id+"details"].cellWidth=h.target.value;_pageIframe.resize()}))}function Property_datacopySource(b,a,d,c){if(a.copyType=="bulk"){b.closest("tr").remove()}else{Property_select(b,a,d,c)}}function Property_datacopySourceField(b,a,d,c){if(a.copyType=="bulk"){b.closest("tr").remove()}else{Property_text(b,a,d,c)}}function Property_datacopyChildField(b,a,d,c){if(a.copyType=="child"){Property_text(b,a,d,c)}else{b.closest("tr").remove()}}function Property_datacopySearchField(b,a,d,c){if(a.copyType=="search"){Property_text(b,a,d,c)
}else{b.closest("tr").remove()}}function Property_datacopySearchSource(b,a,d,c){if(a.copyType=="search"){Property_select(b,a,d,c)}else{b.closest("tr").remove()}}function Property_datacopyDestinations(k,f,j,b){if(f.copyType=="bulk"){k.closest("tr").remove()}else{var g=getDialogue(k,f,j,b,300,"Destinations");var o=g.find("table").first();o.children().remove();var c=[];if(f[j.key]){c=f[j.key]}var l="";o.append("<tr><td><b>Control</b></td><td colspan='2'><b>Field</b></td></tr>");for(var e=0;e<c.length;e++){var n=c[e];if(n){var a=getDataItemDetails(n.itemId);l+=a.name+",";o.append("<tr><td>"+a.name+"</td><td><input value='"+n.field+"' /></td><td style='width:32px'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");var m=o.find("tr").last().children("td:nth(1)").children("input");addListener(m.keyup({dataDestinations:c},function(p){var i=$(p.target);p.data.dataDestinations[i.parent().parent().index()-1].field=i.val()
}));var h=o.find("tr").last().children().last().children("img.delete");addListener(h.click({dataDestinations:c},function(i){var p=$(i.target);i.data.dataDestinations.splice(p.parent().parent().index()-1,1);p.parent().parent().remove()}))}else{c.splice(e,1);e--}}addReorder(c,o.find("img.reorder"),function(){Property_datacopyDestinations(k,f,j,b)});o.append("<tr><td colspan='3' style='padding:0px;'><select style='margin:0px'><option value=''>Add destination...</option>"+getOutputOptions()+"</select></td></tr>");var d=o.find("tr").last().children().last().children().last();addListener(d.change({cell:k,propertyObject:f,property:j,details:b},function(p){if(!p.data.propertyObject[p.data.property.key]){p.data.propertyObject[p.data.property.key]=[]}var i=p.data.propertyObject[p.data.property.key];i.push({itemId:$(p.target).val(),field:""});Property_datacopyDestinations(p.data.cell,p.data.propertyObject,p.data.property,p.data.details)}));if(l){l=l.substring(0,l.length-1)}else{l="Click to add..."
}k.text(l)}}var _dataCopyTypes=[[false,"replace"],["append","append"],["row","row merge"]];function getCopyTypeOptions(c){var a="";for(var b in _dataCopyTypes){a+="<option value='"+_dataCopyTypes[b][0]+"'"+(c==_dataCopyTypes[b][0]?" selected='selected'":"")+">"+_dataCopyTypes[b][1]+"</option>"}return a}function Property_datacopyCopies(m,c,l,b){if(c.copyType=="bulk"){var h=getDialogue(m,c,l,b,700,"Bulk data copies");var o=h.find("table").first();o.children().remove();var e=[];if(c[l.key]){e=c[l.key]}var n="";o.append("<tr><td><b>Source</b></td><td><b>Source field</b></td><td><b>Destination</b></td><td><b>Destination field</b></td><td colspan='2'><b>Copy type</b></td></tr>");for(var g=0;g<e.length;g++){var d=e[g];o.append("<tr class='nopadding'><td><select class='source'><option value=''>Please select...</option>"+getInputOptions(d.source)+"</select></td><td><input  class='source' value='"+d.sourceField+"' /></td><td><select class='destination'><option value=''>Please select...</option>"+getOutputOptions(d.destination)+"</select></td><td><input class='destination' value='"+d.destinationField+"' /></td><td><select class='type' style='min-width:60px;'>"+getCopyTypeOptions(d.type)+"</select></td><td style='width:32px'><img class='delete' src='images/bin_16x16.png' style='float:right;' /><img class='reorder' src='images/moveUpDown_16x16.png' style='float:right;' /></td></tr>");
var a=getDataItemDetails(d.source);var j=getDataItemDetails(d.destination);n+=a.name+" to "+j.name+","}addListener(o.find("select.source").change({dataCopies:e},function(q){var r=$(q.target);var p=r.closest("tr").index()-1;q.data.dataCopies[p].source=r.val()}));addListener(o.find("input.source").keyup({dataCopies:e},function(q){var r=$(q.target);var p=r.closest("tr").index()-1;q.data.dataCopies[p].sourceField=r.val()}));addListener(o.find("select.destination").change({dataCopies:e},function(q){var r=$(q.target);var p=r.closest("tr").index()-1;q.data.dataCopies[p].destination=r.val()}));addListener(o.find("input.destination").change({dataCopies:e},function(q){var r=$(q.target);var p=r.closest("tr").index()-1;q.data.dataCopies[p].destinationField=r.val()}));addListener(o.find("select.type").change({dataCopies:e},function(q){var r=$(q.target);var p=r.closest("tr").index()-1;q.data.dataCopies[p].type=r.val()}));var k=o.find("img.delete");addListener(k.click({dataCopies:e},function(i){var p=$(i.target);
i.data.dataCopies.splice(p.parent().parent().index()-1,1);p.parent().parent().remove()}));addReorder(e,o.find("img.reorder"),function(){Property_datacopyCopies(m,c,l)});o.append("<tr><td colspan='8'><a href='#' style='margin-left:5px;'>add...</a></td></tr>");var f=o.find("a").last();addListener(f.click({cell:m,datacopyAction:c,property:l,details:b},function(p){if(!p.data.datacopyAction.dataCopies){p.data.datacopyAction.dataCopies=[]}var i=p.data.datacopyAction.dataCopies;i.push({source:"",sourceField:"",destination:"",destinationField:""});Property_datacopyCopies(p.data.cell,p.data.datacopyAction,p.data.property,p.data.details)}));if(n){n=n.substring(0,n.length-1)}else{n="Click to add..."}m.text(n)}else{m.closest("tr").remove()}}function Property_controlActionType(a,c,d,b){if(!c.actionType){if(c.command&&c.command!='// Enter JQuery command here. The event object is passed in as "ev"'){c.actionType="custom"}else{c.actionType="hide"}}Property_select(a,c,d)}function Property_controlActionDuration(a,c,d,b){if(c.actionType.indexOf("slide")==0||c.actionType.indexOf("fade")==0){Property_integer(a,c,d)
}else{a.closest("tr").remove()}}function Property_controlActionClasses(a,c,d,b){if(c.actionType=="addClass"||c.actionType=="removeClass"||c.actionType=="toggleClass"||c.actionType=="removeChildClasses"){Property_select(a,c,d,b)}else{a.closest("tr").remove()}}function Property_controlActionCommand(a,c,d,b){if(c.actionType=="custom"){Property_bigtext(a,c,d,b)}else{a.closest("tr").remove()}}var _fontawesomeGlyphs=[["","none"],["&#xf042;","adjust"],["&#xf170;","adn"],["&#xf037;","align-center"],["&#xf039;","align-justify"],["&#xf036;","align-left"],["&#xf038;","align-right"],["&#xf0f9;","ambulance"],["&#xf13d;","anchor"],["&#xf17b;","android"],["&#xf209;","angellist"],["&#xf103;","angle-double-down"],["&#xf100;","angle-double-left"],["&#xf101;","angle-double-right"],["&#xf102;","angle-double-up"],["&#xf107;","angle-down"],["&#xf104;","angle-left"],["&#xf105;","angle-right"],["&#xf106;","angle-up"],["&#xf179;","apple"],["&#xf187;","archive"],["&#xf1fe;","area-chart"],["&#xf0ab;","arrow-circle-down"],["&#xf0a8;","arrow-circle-left"],["&#xf01a;","arrow-circle-o-down"],["&#xf190;","arrow-circle-o-left"],["&#xf18e;","arrow-circle-o-right"],["&#xf01b;","arrow-circle-o-up"],["&#xf0a9;","arrow-circle-right"],["&#xf0aa;","arrow-circle-up"],["&#xf063;","arrow-down"],["&#xf060;","arrow-left"],["&#xf061;","arrow-right"],["&#xf047;","arrows"],["&#xf0b2;","arrows-alt"],["&#xf07e;","arrows-h"],["&#xf07d;","arrows-v"],["&#xf062;","arrow-up"],["&#xf069;","asterisk"],["&#xf1fa;","at"],["&#xf04a;","backward"],["&#xf05e;","ban"],["&#xf080;","bar-chart"],["&#xf02a;","barcode"],["&#xf0c9;","bars"],["&#xf0fc;","beer"],["&#xf1b4;","behance"],["&#xf1b5;","behance-square"],["&#xf0f3;","bell"],["&#xf0a2;","bell-o"],["&#xf1f6;","bell-slash"],["&#xf1f7;","bell-slash-o"],["&#xf206;","bicycle"],["&#xf1e5;","binoculars"],["&#xf1fd;","birthday-cake"],["&#xf171;","bitbucket"],["&#xf172;","bitbucket-square"],["&#xf032;","bold"],["&#xf0e7;","bolt"],["&#xf1e2;","bomb"],["&#xf02d;","book"],["&#xf02e;","bookmark"],["&#xf097;","bookmark-o"],["&#xf0b1;","briefcase"],["&#xf15a;","btc"],["&#xf188;","bug"],["&#xf1ad;","building"],["&#xf0f7;","building-o"],["&#xf0a1;","bullhorn"],["&#xf140;","bullseye"],["&#xf207;","bus"],["&#xf1ec;","calculator"],["&#xf073;","calendar"],["&#xf133;","calendar-o"],["&#xf030;","camera"],["&#xf083;","camera-retro"],["&#xf1b9;","car"],["&#xf0d7;","caret-down"],["&#xf0d9;","caret-left"],["&#xf0da;","caret-right"],["&#xf150;","caret-square-o-down"],["&#xf191;","caret-square-o-left"],["&#xf152;","caret-square-o-right"],["&#xf151;","caret-square-o-up"],["&#xf0d8;","caret-up"],["&#xf20a;","cc"],["&#xf1f3;","cc-amex"],["&#xf1f2;","cc-discover"],["&#xf1f1;","cc-mastercard"],["&#xf1f4;","cc-paypal"],["&#xf1f5;","cc-stripe"],["&#xf1f0;","cc-visa"],["&#xf0a3;","certificate"],["&#xf127;","chain-broken"],["&#xf00c;","check"],["&#xf058;","check-circle"],["&#xf05d;","check-circle-o"],["&#xf14a;","check-square"],["&#xf046;","check-square-o"],["&#xf13a;","chevron-circle-down"],["&#xf137;","chevron-circle-left"],["&#xf138;","chevron-circle-right"],["&#xf139;","chevron-circle-up"],["&#xf078;","chevron-down"],["&#xf053;","chevron-left"],["&#xf054;","chevron-right"],["&#xf077;","chevron-up"],["&#xf1ae;","child"],["&#xf111;","circle"],["&#xf10c;","circle-o"],["&#xf1ce;","circle-o-notch"],["&#xf1db;","circle-thin"],["&#xf0ea;","clipboard"],["&#xf017;","clock-o"],["&#xf0c2;","cloud"],["&#xf0ed;","cloud-download"],["&#xf0ee;","cloud-upload"],["&#xf121;","code"],["&#xf126;","code-fork"],["&#xf1cb;","codepen"],["&#xf0f4;","coffee"],["&#xf013;","cog"],["&#xf085;","cogs"],["&#xf0db;","columns"],["&#xf075;","comment"],["&#xf0e5;","comment-o"],["&#xf086;","comments"],["&#xf0e6;","comments-o"],["&#xf14e;","compass"],["&#xf066;","compress"],["&#xf1f9;","copyright"],["&#xf09d;","credit-card"],["&#xf125;","crop"],["&#xf05b;","crosshairs"],["&#xf13c;","css3"],["&#xf1b2;","cube"],["&#xf1b3;","cubes"],["&#xf0f5;","cutlery"],["&#xf1c0;","database"],["&#xf1a5;","delicious"],["&#xf108;","desktop"],["&#xf1bd;","deviantart"],["&#xf1a6;","digg"],["&#xf192;","dot-circle-o"],["&#xf019;","download"],["&#xf17d;","dribbble"],["&#xf16b;","dropbox"],["&#xf1a9;","drupal"],["&#xf052;","eject"],["&#xf141;","ellipsis-h"],["&#xf142;","ellipsis-v"],["&#xf1d1;","empire"],["&#xf0e0;","envelope"],["&#xf003;","envelope-o"],["&#xf199;","envelope-square"],["&#xf12d;","eraser"],["&#xf153;","eur"],["&#xf0ec;","exchange"],["&#xf12a;","exclamation"],["&#xf06a;","exclamation-circle"],["&#xf071;","exclamation-triangle"],["&#xf065;","expand"],["&#xf08e;","external-link"],["&#xf14c;","external-link-square"],["&#xf06e;","eye"],["&#xf1fb;","eyedropper"],["&#xf070;","eye-slash"],["&#xf09a;","facebook"],["&#xf082;","facebook-square"],["&#xf049;","fast-backward"],["&#xf050;","fast-forward"],["&#xf1ac;","fax"],["&#xf182;","female"],["&#xf0fb;","fighter-jet"],["&#xf15b;","file"],["&#xf1c6;","file-archive-o"],["&#xf1c7;","file-audio-o"],["&#xf1c9;","file-code-o"],["&#xf1c3;","file-excel-o"],["&#xf1c5;","file-image-o"],["&#xf016;","file-o"],["&#xf1c1;","file-pdf-o"],["&#xf1c4;","file-powerpoint-o"],["&#xf0c5;","files-o"],["&#xf15c;","file-text"],["&#xf0f6;","file-text-o"],["&#xf1c8;","file-video-o"],["&#xf1c2;","file-word-o"],["&#xf008;","film"],["&#xf0b0;","filter"],["&#xf06d;","fire"],["&#xf134;","fire-extinguisher"],["&#xf024;","flag"],["&#xf11e;","flag-checkered"],["&#xf11d;","flag-o"],["&#xf0c3;","flask"],["&#xf16e;","flickr"],["&#xf0c7;","floppy-o"],["&#xf07b;","folder"],["&#xf114;","folder-o"],["&#xf07c;","folder-open"],["&#xf115;","folder-open-o"],["&#xf031;","font"],["&#xf04e;","forward"],["&#xf180;","foursquare"],["&#xf119;","frown-o"],["&#xf1e3;","futbol-o"],["&#xf11b;","gamepad"],["&#xf0e3;","gavel"],["&#xf154;","gbp"],["&#xf06b;","gift"],["&#xf1d3;","git"],["&#xf09b;","github"],["&#xf113;","github-alt"],["&#xf092;","github-square"],["&#xf1d2;","git-square"],["&#xf184;","gittip"],["&#xf000;","glass"],["&#xf0ac;","globe"],["&#xf1a0;","google"],["&#xf0d5;","google-plus"],["&#xf0d4;","google-plus-square"],["&#xf1ee;","google-wallet"],["&#xf19d;","graduation-cap"],["&#xf1d4;","hacker-news"],["&#xf0a7;","hand-o-down"],["&#xf0a5;","hand-o-left"],["&#xf0a4;","hand-o-right"],["&#xf0a6;","hand-o-up"],["&#xf0a0;","hdd-o"],["&#xf1dc;","header"],["&#xf025;","headphones"],["&#xf004;","heart"],["&#xf08a;","heart-o"],["&#xf1da;","history"],["&#xf015;","home"],["&#xf0f8;","hospital-o"],["&#xf0fd;","h-square"],["&#xf13b;","html5"],["&#xf20b;","ils"],["&#xf01c;","inbox"],["&#xf03c;","indent"],["&#xf129;","info"],["&#xf05a;","info-circle"],["&#xf156;","inr"],["&#xf16d;","instagram"],["&#xf208;","ioxhost"],["&#xf033;","italic"],["&#xf1aa;","joomla"],["&#xf157;","jpy"],["&#xf1cc;","jsfiddle"],["&#xf084;","key"],["&#xf11c;","keyboard-o"],["&#xf159;","krw"],["&#xf1ab;","language"],["&#xf109;","laptop"],["&#xf202;","lastfm"],["&#xf203;","lastfm-square"],["&#xf06c;","leaf"],["&#xf094;","lemon-o"],["&#xf149;","level-down"],["&#xf148;","level-up"],["&#xf1cd;","life-ring"],["&#xf0eb;","lightbulb-o"],["&#xf201;","line-chart"],["&#xf0c1;","link"],["&#xf0e1;","linkedin"],["&#xf08c;","linkedin-square"],["&#xf17c;","linux"],["&#xf03a;","list"],["&#xf022;","list-alt"],["&#xf0cb;","list-ol"],["&#xf0ca;","list-ul"],["&#xf124;","location-arrow"],["&#xf023;","lock"],["&#xf175;","long-arrow-down"],["&#xf177;","long-arrow-left"],["&#xf178;","long-arrow-right"],["&#xf176;","long-arrow-up"],["&#xf0d0;","magic"],["&#xf076;","magnet"],["&#xf183;","male"],["&#xf041;","map-marker"],["&#xf136;","maxcdn"],["&#xf20c;","meanpath"],["&#xf0fa;","medkit"],["&#xf11a;","meh-o"],["&#xf130;","microphone"],["&#xf131;","microphone-slash"],["&#xf068;","minus"],["&#xf056;","minus-circle"],["&#xf146;","minus-square"],["&#xf147;","minus-square-o"],["&#xf10b;","mobile"],["&#xf0d6;","money"],["&#xf186;","moon-o"],["&#xf001;","music"],["&#xf1ea;","newspaper-o"],["&#xf19b;","openid"],["&#xf03b;","outdent"],["&#xf18c;","pagelines"],["&#xf1fc;","paint-brush"],["&#xf0c6;","paperclip"],["&#xf1d8;","paper-plane"],["&#xf1d9;","paper-plane-o"],["&#xf1dd;","paragraph"],["&#xf04c;","pause"],["&#xf1b0;","paw"],["&#xf1ed;","paypal"],["&#xf040;","pencil"],["&#xf14b;","pencil-square"],["&#xf044;","pencil-square-o"],["&#xf095;","phone"],["&#xf098;","phone-square"],["&#xf03e;","picture-o"],["&#xf200;","pie-chart"],["&#xf1a7;","pied-piper"],["&#xf1a8;","pied-piper-alt"],["&#xf0d2;","pinterest"],["&#xf0d3;","pinterest-square"],["&#xf072;","plane"],["&#xf04b;","play"],["&#xf144;","play-circle"],["&#xf01d;","play-circle-o"],["&#xf1e6;","plug"],["&#xf067;","plus"],["&#xf055;","plus-circle"],["&#xf0fe;","plus-square"],["&#xf196;","plus-square-o"],["&#xf011;","power-off"],["&#xf02f;","print"],["&#xf12e;","puzzle-piece"],["&#xf1d6;","qq"],["&#xf029;","qrcode"],["&#xf128;","question"],["&#xf059;","question-circle"],["&#xf10d;","quote-left"],["&#xf10e;","quote-right"],["&#xf074;","random"],["&#xf1d0;","rebel"],["&#xf1b8;","recycle"],["&#xf1a1;","reddit"],["&#xf1a2;","reddit-square"],["&#xf021;","refresh"],["&#xf18b;","renren"],["&#xf01e;","repeat"],["&#xf112;","reply"],["&#xf122;","reply-all"],["&#xf079;","retweet"],["&#xf018;","road"],["&#xf135;","rocket"],["&#xf09e;","rss"],["&#xf143;","rss-square"],["&#xf158;","rub"],["&#xf0c4;","scissors"],["&#xf002;","search"],["&#xf010;","search-minus"],["&#xf00e;","search-plus"],["&#xf064;","share"],["&#xf1e0;","share-alt"],["&#xf1e1;","share-alt-square"],["&#xf14d;","share-square"],["&#xf045;","share-square-o"],["&#xf132;","shield"],["&#xf07a;","shopping-cart"],["&#xf012;","signal"],["&#xf090;","sign-in"],["&#xf08b;","sign-out"],["&#xf0e8;","sitemap"],["&#xf17e;","skype"],["&#xf198;","slack"],["&#xf1de;","sliders"],["&#xf1e7;","slideshare"],["&#xf118;","smile-o"],["&#xf0dc;","sort"],["&#xf15d;","sort-alpha-asc"],["&#xf15e;","sort-alpha-desc"],["&#xf160;","sort-amount-asc"],["&#xf161;","sort-amount-desc"],["&#xf0de;","sort-asc"],["&#xf0dd;","sort-desc"],["&#xf162;","sort-numeric-asc"],["&#xf163;","sort-numeric-desc"],["&#xf1be;","soundcloud"],["&#xf197;","space-shuttle"],["&#xf110;","spinner"],["&#xf1b1;","spoon"],["&#xf1bc;","spotify"],["&#xf0c8;","square"],["&#xf096;","square-o"],["&#xf18d;","stack-exchange"],["&#xf16c;","stack-overflow"],["&#xf005;","star"],["&#xf089;","star-half"],["&#xf123;","star-half-o"],["&#xf006;","star-o"],["&#xf1b6;","steam"],["&#xf1b7;","steam-square"],["&#xf048;","step-backward"],["&#xf051;","step-forward"],["&#xf0f1;","stethoscope"],["&#xf04d;","stop"],["&#xf0cc;","strikethrough"],["&#xf1a4;","stumbleupon"],["&#xf1a3;","stumbleupon-circle"],["&#xf12c;","subscript"],["&#xf0f2;","suitcase"],["&#xf185;","sun-o"],["&#xf12b;","superscript"],["&#xf0ce;","table"],["&#xf10a;","tablet"],["&#xf0e4;","tachometer"],["&#xf02b;","tag"],["&#xf02c;","tags"],["&#xf0ae;","tasks"],["&#xf1ba;","taxi"],["&#xf1d5;","tencent-weibo"],["&#xf120;","terminal"],["&#xf034;","text-height"],["&#xf035;","text-width"],["&#xf00a;","th"],["&#xf009;","th-large"],["&#xf00b;","th-list"],["&#xf165;","thumbs-down"],["&#xf088;","thumbs-o-down"],["&#xf087;","thumbs-o-up"],["&#xf164;","thumbs-up"],["&#xf08d;","thumb-tack"],["&#xf145;","ticket"],["&#xf00d;","times"],["&#xf057;","times-circle"],["&#xf05c;","times-circle-o"],["&#xf043;","tint"],["&#xf204;","toggle-off"],["&#xf205;","toggle-on"],["&#xf1f8;","trash"],["&#xf014;","trash-o"],["&#xf1bb;","tree"],["&#xf181;","trello"],["&#xf091;","trophy"],["&#xf0d1;","truck"],["&#xf195;","try"],["&#xf1e4;","tty"],["&#xf173;","tumblr"],["&#xf174;","tumblr-square"],["&#xf1e8;","twitch"],["&#xf099;","twitter"],["&#xf081;","twitter-square"],["&#xf0e9;","umbrella"],["&#xf0cd;","underline"],["&#xf0e2;","undo"],["&#xf19c;","university"],["&#xf09c;","unlock"],["&#xf13e;","unlock-alt"],["&#xf093;","upload"],["&#xf155;","usd"],["&#xf007;","user"],["&#xf0f0;","user-md"],["&#xf0c0;","users"],["&#xf03d;","video-camera"],["&#xf194;","vimeo-square"],["&#xf1ca;","vine"],["&#xf189;","vk"],["&#xf027;","volume-down"],["&#xf026;","volume-off"],["&#xf028;","volume-up"],["&#xf18a;","weibo"],["&#xf1d7;","weixin"],["&#xf193;","wheelchair"],["&#xf1eb;","wifi"],["&#xf17a;","windows"],["&#xf19a;","wordpress"],["&#xf0ad;","wrench"],["&#xf168;","xing"],["&#xf169;","xing-square"],["&#xf19e;","yahoo"],["&#xf1e9;","yelp"],["&#xf167;","youtube"],["&#xf16a;","youtube-play"],["&#xf166;","youtube-square"]];
function getGlyphNameByCode(b){for(var a in _fontawesomeGlyphs){if(_fontawesomeGlyphs[a][0]==b){return _fontawesomeGlyphs[a][1]}}}function Property_glyphCode(b,e,g,d){var f=e[g.key];if(f){b.append("<span class='fa'>"+f+"</span>&nbsp;"+getGlyphNameByCode(f))}else{b.append("Please select...")}var a=getDialogue(b,e,g,d,200,"Glyphs");a.find("table").first().remove();a.append("<div style='overflow-y:scroll;max-height:400px;'><table></table></div>");table=a.find("table").first();for(var c in _fontawesomeGlyphs){table.append("<tr><td data-code='"+_fontawesomeGlyphs[c][0].replace("&","&amp;")+"' class='hover"+(f&&f==_fontawesomeGlyphs[c][0]?" selected":"")+"'><span class='fa'>"+_fontawesomeGlyphs[c][0]+"</span><span class='fa_name'>&nbsp;"+_fontawesomeGlyphs[c][1]+"</span></td></tr>")}if(a.attr("data-scroll")){table.parent().scrollTop(a.attr("data-scroll"))}addListener(table.find("td").click({cell:b,controlAction:e,property:g,details:d},function(k){var h=$(k.target).closest("td");h.closest("table").find("td").removeClass("selected");
h.addClass("selected");var j=h.attr("data-code");var i=h.closest("table");a.attr("data-scroll",i.parent().scrollTop());updateProperty(k.data.cell,k.data.controlAction,k.data.property,k.data.details,j)}))}function Property_buttonGlyphPosition(a,b,d,c){if(b.glyphCode){Property_select(a,b,d,c)}else{a.closest("tr").remove()}}function Property_buttonGlyphBackground(a,b,d,c){if(b.glyphCode){Property_select(a,b,d,c)}else{a.closest("tr").remove()}}function Property_mapLatLng(a,b,f,d){var e="";if(b[f.key]||parseInt(b[f.key])==0){e=b[f.key]}a.append("<input class='propertiesPanelTable' value='"+e+"' />");var c=a.children().last();addListener(c.change(function(i){var h=$(i.target);var k=h.val();if(k.match(new RegExp("^-?((\\d+(\\.\\d*)?)|(\\.\\d+))$"))){updateProperty(a,b,f,d,i.target.value);var g=_pageIframe[0].contentWindow;var j=g._maps[b.id];j.setCenter(new g.google.maps.LatLng(b.lat,b.lng))}else{h.val(b[f.key])}}))}function Property_mapZoom(a,b,f,d){var e="";if(b[f.key]||parseInt(b[f.key])==0){e=b[f.key]
}a.append("<input class='propertiesPanelTable' value='"+e+"' />");var c=a.children().last();addListener(c.change(function(i){var h=$(i.target);var k=h.val();if(k.match(new RegExp("^\\d+$"))){k=parseInt(k);updateProperty(a,b,f,d,k);var g=_pageIframe[0].contentWindow;var j=g._maps[b.id];j.setZoom(k)}else{h.val(b[f.key])}}))}function Property_device(b,c,g,f){var d="";for(var e in _devices){if(e*1==_device){d+="<option value='"+e+"' selected='selected'>"+_devices[e].name+"</option>"}else{d+="<option value='"+e+"'>"+_devices[e].name+"</option>"}}b.append("<select class='propertiesPanelTable'>"+d+"</select>");var a=b.children().last();addListener(a.change(function(h){_device=$(h.target).val()*1;if(typeof(localStorage)!=="undefined"){localStorage.setItem("_device",_device)}_scale=_ppi/_devices[_device].PPI*_devices[_device].scale*_zoom;$("#scrollV").hide();$("#scrollH").hide();windowResize("_device");_pageIframe.resize()}));if(!c[g.key]){c[g.key]=a.val()*1}}function Property_zoom(b,c,h,g){var e="";
var d=[[0.5,"50%"],[1,"100%"],[1.5,"150%"],[2,"200%"],[3,"300%"],[4,"400%"]];for(var f in d){if(d[f][0]==_zoom){e+="<option value='"+d[f][0]+"' selected='selected'>"+d[f][1]+"</option>"}else{e+="<option value='"+d[f][0]+"'>"+d[f][1]+"</option>"}}b.append("<select class='propertiesPanelTable'>"+e+"</select>");var a=b.children().last();addListener(a.change(function(i){_zoom=$(i.target).val()*1;if(typeof(localStorage)!=="undefined"){localStorage.setItem("_zoom",_zoom)}_scale=_ppi/_devices[_device].PPI*_devices[_device].scale*_zoom;$("#scrollV").hide();$("#scrollH").hide();windowResize("_zoom")}))}function Property_orientation(a,b,d,c){if(_orientation=="P"){a.text("Portrait")}else{a.text("Landscape")}addListener(a.click(function(e){if(_orientation=="P"){_orientation="L";$(e.target).text("Landscape")}else{_orientation="P";$(e.target).text("Portrait")}if(typeof(localStorage)!=="undefined"){localStorage.setItem("_orientation",_orientation)}$("#scrollV").hide();$("#scrollH").hide();windowResize("_orientation")
}))}var _mobileActionTypes=[["addImage","Add image"],["uploadImages","Upload images"],["sendGPS","Send GPS position"],["stopGPS","Stop GPS updates"],["message","Status bar message"],["disableBackButton","Disable back button"]];function Property_mobileActionType(a,g,f,e){var b="<select>";for(var d in _mobileActionTypes){b+="<option value='"+_mobileActionTypes[d][0]+"'"+(g.actionType==_mobileActionTypes[d][0]?" selected='selected'":"")+">"+_mobileActionTypes[d][1]+"</option>"}b+="</select>";var c=a.append(b).find("select");setPropertyVisibilty(g,"galleryControlId",false);setPropertyVisibilty(g,"imageMaxSize",false);setPropertyVisibilty(g,"imageQuality",false);setPropertyVisibilty(g,"successActions",false);setPropertyVisibilty(g,"errorActions",false);setPropertyVisibilty(g,"gpsDestinations",false);setPropertyVisibilty(g,"gpsFrequency",false);setPropertyVisibilty(g,"gpsCheck",false);setPropertyVisibilty(g,"message",false);switch(g.actionType){case"addImage":setPropertyVisibilty(g,"galleryControlId",true);
setPropertyVisibilty(g,"imageMaxSize",true);setPropertyVisibilty(g,"imageQuality",true);break;case"uploadImages":setPropertyVisibilty(g,"galleryControlId",true);setPropertyVisibilty(g,"successActions",true);setPropertyVisibilty(g,"errorActions",true);break;case"sendGPS":setPropertyVisibilty(g,"gpsDestinations",true);setPropertyVisibilty(g,"gpsFrequency",true);setPropertyVisibilty(g,"gpsCheck",true);break;case"message":setPropertyVisibilty(g,"message",true);break}addListener(c.change({cell:a,mobileAction:g,property:f,details:e},function(h){value=$(h.target).val();updateProperty(h.data.cell,h.data.mobileAction,h.data.property,h.data.details,value)}))};